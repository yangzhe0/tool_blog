---
title: ANCOJ
published: 2024-11-21
tags: [Jupiter]
description: A New Catalogue of Observations of JupiterğŸŒŒ
category: Work
draft: false
---

## 1. Organization

- **2024.11: å®ŒæˆNSDCçš„æ•°æ®å¤„ç†âœ…**
- **2024.12: æœé›†æ–°æ•°æ®æ•´ç†&å‡†å¤‡è€ƒè¯•ğŸ“š**
- **2025.01: å®Œæˆæ‰€æœ‰çš„æ•°æ®&è½¬æ¢ğŸ”„**
- **2025.02: å®Œå–„æ•°æ®åˆ†æ&çŸ«æ­£å¹¶æ’°å†™åˆç¨¿âœ**
- **2025.03: æ­£å¼æ’°å†™æ–‡ç« ğŸ“„**
- **2025.04: å®Œå–„æ–‡ç« å‡†å¤‡æŠ•é€’ğŸ“¬**

## 2. Record

### Date Preprocessing

#### 1. html info

é¦–å…ˆï¼Œå› ä¸ºNSDCä¸Šçš„æ•°æ®æ˜¯ä»¥content+dataçš„åŒæ–‡ä»¶å½¢å¼å­˜å‚¨çš„ã€‚ç¼–å†™ä¸€ä¸ªç±»ä¼¼äºçˆ¬è™«çš„æ–‡æœ¬åˆ†ææ–‡ä»¶ï¼Œå°†æ¯ä¸€ä¸ªcontent çš„ç›¸å…³æ•°æ®éƒ½æ•´ç†åˆ°äº†ä¸€ä¸ªcsvæ–‡ä»¶ï¼Œç§°ä¹‹ä¸ºinformationã€‚Informationé‡ŒåŒ…å«äº†æ—¶é—´ç³»ç»Ÿã€åæ ‡ç³»ç»Ÿå’Œè§‚æµ‹å°ç­‰ä¿¡æ¯ï¼Œæ–¹ä¾¿åœ¨æŸäº›æ•°æ®è®°å½•ä¸­ä¸åŒ…å«æŸäº›æ•°æ®æ—¶è¡¥ä¸Šã€‚
Informationä¸­åŒ…å«äº†ä»¥ä¸‹å­—æ®µçš„ä¿¡æ¯
Idã€Typeã€Datesã€Observatoryã€Reference Frameã€Centre of Frame
Epoch of Equinoxã€Time Scaleã€Reductionã€Coordinatesã€Diffraction
Receptorã€Telescopeã€Observersã€Relative To

![](image1-1736183370013-1.png)

å…¶æ¬¡ï¼Œå› ä¸ºæœ€ä¸€å¼€å§‹å¹¶ä¸äº†è§£æ—¶é—´ç³»ç»Ÿå’Œåæ ‡ç³»ç»Ÿçš„æ¦‚å¿µå’Œå®šä¹‰ï¼Œæ•…ç»Ÿè®¡å‡ºäº†informationä¸­å‡ºç°çš„æ‰€æœ‰æ—¶é—´ç³»ç»Ÿçš„ç±»å‹ã€‚

![](image2-1736183370014-2.png)

![](image3-1736183370014-3.png)

![](image4-1736183370014-4.png)

#### 2. csv errror

Pythonå¯¹txtæ–‡ä»¶å¹¶ä¸ç®—ç‰¹åˆ«å‹å¥½ï¼Œè®¡åˆ’å°†txtæ–‡ä»¶è½¬æ¢æˆäº†csvæ–‡ä»¶æ–¹ä¾¿ä¹‹åçš„å„ç§æ“ä½œï¼Œä½†æ˜¯è½¬æ¢é€”ä¸­å‘ç°æœ‰çš„è§‚æµ‹æ•°æ®çš„æ ¼å¼å¹¶ä¸å®Œæ•´ï¼Œç¼–å†™äº†ä¸€ä¸ªcsv_errorç¨‹åºåˆ†ææ ¼å¼é”™è¯¯å¹¶æ”¹æ­£ã€‚

![](image5-1736183370014-5.png)

æ”¹æ­£æ‰€æœ‰é”™è¯¯ä¹‹åå¼€å§‹å¯¹txtæ–‡ä»¶è¿›è¡Œè½¬æ¢ã€‚å¹¶ç»™æ‰€æœ‰çš„csvæ–‡ä»¶æ·»åŠ äº†ä¸€ä¸ªè¡¨å¤´ï¼Œä¾¿äºæ ¹æ®è¡¨å¤´å®ç°å¯¹å¤šè¡¨çš„åˆå¹¶ã€‚

#### 3. csv convert

è½¬æ¢ä¹‹åçš„csvæ–‡ä»¶å¦‚ä¸‹ï¼Œæˆ‘ä¸ºæ¯ä¸ªæ•°æ®åŠ ä¸Šå‰åæ‹¬å·å¼ºåˆ¶è½¬æ¢ä¸ºæ–‡æœ¬ï¼Œé˜²æ­¢æ•°æ®ç²¾åº¦ä¸¢å¤±ã€‚

![](image6-1736183370014-8.png)

#### 4. csv header

ä¸ºäº†æ‰¹é‡å¤„ç†æ—¶é—´åˆ°ç»Ÿä¸€çš„æ ¼å¼ï¼Œäº¦æˆ–æ–¹ä¾¿å»å¯¹ä¸åŒçš„æ•°æ®ç±»å‹å¤„ç†ï¼Œä¾‹å¦‚æœ‰äº›æ•°æ®æ˜¯èµ¤ç»èµ¤çº¬ï¼Œæœ‰äº›æ•°æ®æ˜¯ç©ºé—´åæ ‡ã€‚å› æ­¤è¦å°†Dataä¸­çš„æ•°æ®å¯¹åº”ä¸Šç›¸åº”çš„åˆ—åï¼Œç¼–å†™äº†ä¸€ä¸ªç¨‹åºé¦–å…ˆç»™æ‰€æœ‰csvæ–‡ä»¶å¢åŠ ä¸€è¡Œæ ‡é¢˜è¡Œï¼Œç„¶åé€šè¿‡ç¼–å†™ä¸€ä¸ªè½¯ä»¶å®ç°ç›´æ¥æ›´æ”¹å„ä¸ªæ–‡ä»¶çš„è¡¨å¤´çš„åŠŸèƒ½ï¼Œå¦å¤–ä¸ºäº†é˜²æ­¢å‡ºé”™ï¼Œåœ¨å³ä¾§ä¼šåŒæ­¥è¾“å‡ºhtmlæ–‡ä»¶ï¼Œæœ€ååŠ ä¸ŠäºŒæ¬¡éªŒè¯ã€‚ç¡®ä¿æ‰€æœ‰çš„æ•°æ®æ˜¯å‡†ç¡®æ— è¯¯çš„ã€‚
æ›¿æ¢è¡¨å¤´ç¨‹åºï¼š

![](image7-1736183370014-6.png)

#### 5. csv utils

![](image9-1736183370014-7.png)

### Date Conversion

#### 1. csv merge

åŸºäºä¸Šè¿°çš„æ•°æ®å‡†å¤‡ï¼Œç¼–å†™ä¸€ä¸ªç®€å•çš„ç¨‹åºå°±èƒ½å®ç°å¤šè¡¨åˆå¹¶ï¼Œè¿˜ä¸ºæ‰€æœ‰çš„è¡Œéƒ½æ–°å¢äº†ä¸€åˆ—idï¼Œä»¥æ–‡ä»¶å+è¡Œå·å½¢å¼æ„æˆï¼Œæ–¹ä¾¿å¯¹æ•°æ®çš„æ£€ç´¢å’Œå¯¹æŸäº›æŒ‡å®šçš„æ•°æ®æ•´ç†ã€‚æ•´åˆä¹‹åçš„è¡¨æ ¼å¦‚ä¸‹ã€‚ä¸€å…±åŒ…å«äº†å†…éƒ¨ã€å¤–éƒ¨ã€ä¼½åˆ©ç•¥å«æ˜Ÿç­‰åå‡ ä¸ªå«æ˜Ÿçš„5ä¸‡å¤šæ¡è§‚æµ‹æ•°æ®ï¼ŒåŸºæœ¬å®ç°äº†å¯¹è§‚æµ‹æ•°æ®çš„æ•´åˆã€‚

![](image8-1736183370014-9.png)

#### 2. csv extractor

é€šè¿‡å‰æœŸæ•´ç†ï¼Œæ€»è®¡æ•´ç†äº†57258æ¡å«æ˜Ÿæ˜Ÿè¡¨æ•°æ®ã€‚åŸå§‹æ–‡ä»¶ç±»å‹

| file_line    | year       | mon      | day             | hour | min  | sec  | JD   |
| ------------ | ---------- | -------- | --------------- | ---- | ---- | ---- | ---- |
| **jg0002_2** | **[1998]** | **[08]** | **[26.999456]** |      |      |      |      |

ä½¿ç”¨excelå‡½æ•°å¯ä»¥å®ç°å¯¹æ•°æ®çš„åˆ†ç±»ã€‚

```
=IF(AND(ISNUMBER(SEARCH(".", D2)), D2<>"", E2="", F2="", G2="", H2="", I2="", J2="", A2<>""), 1,
   IF(AND(A2<>"", B2<>"", C2<>"", D2<>"", E2<>"", F2<>"", G2<>"", H2="", I2="", J2=""), 2,
   IF(AND(H2<>"", I2="", J2=""), 3,
   4)))
```

æ•´ç†å¦‚ä¸‹

| æ—¶é—´ç³»ç»Ÿ                                                     | æ•°æ®ç±»å‹                                                     | æ•°æ®æ•°é‡                                                   |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ---------------------------------------------------------- |
| **UTC<br/>TT<br/>GMT<br/>Cape sideral time<br/>UT1<br/>UTC-3h<br/>ET<br/>TCB<br/>TDB** | **ç¬¬1ç±»ï¼š** åªæœ‰ `file_line`ã€`year`ã€`mon`ã€`day` æœ‰å€¼ï¼Œä¸” `day` åˆ—çš„å€¼å«å°æ•°ç‚¹ï¼Œå…¶ä½™åˆ—ä¸ºç©ºã€‚<br/>**ç¬¬2ç±»ï¼š** åªæœ‰ `file_line`ã€`year`ã€`mon`ã€`day`ã€`hour`ã€`min`ã€`sec` æœ‰å€¼ï¼Œå…¶ä½™åˆ—ä¸ºç©ºã€‚<br/>**ç¬¬3ç±»ï¼š** åªæœ‰ `jd` åˆ—æœ‰å€¼ï¼Œå…¶ä½™åˆ—ä¸ºç©ºã€‚<br/>**ç¬¬4ç±»ï¼š** ä¸ç¬¦åˆä¸Šè¿°ä»»ä½•è§„åˆ™ã€‚ | **1	22964<br/>2	10726<br/>3	14396<br/>4	9172** |

![](image10-1736183370014-10.png)

å¼‚å¸¸æ•°æ®

| æ–‡ä»¶å     | ç±»åˆ«  | å‡ºç°æ€»æ¬¡æ•° | å¼‚å¸¸                      | å¤„ç†                                                         |
| ---------- | ----- | ---------- | ------------------------- | ------------------------------------------------------------ |
| **jg0001** | **2** | **1606**   | **secæ ¼å¼ä¸ä¸€**           |                                                              |
| **jg0004** | **3** | **144**    | **æœ‰jd,æ— æ—¶åˆ†ç§’**         | **æŒ‰jd**                                                     |
| **jg0008** | **4** | **738**    | **Cape sideral time**     |                                                              |
| **jg0032** | **3** | **448**    | **æœ‰jd,æœ‰å¹´æœˆå¸¦å°æ•°çš„ç§’** | **æŒ‰jd**                                                     |
| **ji0015** | **3** | **54**     | **jd**                    | **Julian date of observation (TDB)**                         |
| **jg0020** | **4** | **26**     | **mjd**                   | **MJD - time of topocentric observation (MJD=JD-2400000.5), TT** |
| **jg0021** | **4** | **16**     | **mjd**                   | **MJD - time of topocentric observation (MJD=JD-2400000.5), TT** |
| **jg0069** | **4** | **209**    | **Epoch_TCB**             | **Gaia-centric epoch in TCB relative to 2455197.5 (Epoch_TCB, days)** |
| **jg0073** | **4** | **295**    | **Epoch_TCB**             | **Gaia-centric epoch in TCB relative to 2455197.5 (Epoch_TCB, days)** |
| **ji0001** | **4** | **35**     | **hourå¸¦å°æ•°æ— min sec**   | **Hour of the moment of observation with decimals**          |
| **ji0002** | **4** | **160**    | **hourå¸¦å°æ•°æ— min sec**   | **Hour of the moment of observation with decimals**          |
| **ji0004** | **4** | **123**    | **hourå¸¦å°æ•°æ— min sec**   | **Hour of the moment of observation with decimals**          |
| **ji0005** | **4** | **156**    | **min**                   | **Minutes from 0 h UTC, 3 December 1988 (JD=2447498.5)**     |
| **ji0007** | **4** | **10**     | **mjd**                   | **MJD of observation with decimals (43494 = 17 Dec 1977)**   |
| **jo0069** | **4** | **1712**   | **Epoch_TCB**             | **Gaia-centric epoch in TCB relative to 2455197.5 (Epoch_TCB, days)** |
| **jo0077** | **4** | **3756**   | **Epoch_TCB**             | **Gaia-centric epoch in TCB relative to 2455197.5 (Epoch_TCB, days)** |
| **jo1057** | **4** | **92**     | **Epoch_TCB**             | **Gaia-centric epoch in TCB relative to 2455197.5 (Epoch_TCB, days)** |
| **jo1061** | **4** | **238**    | **Epoch_TCB**             | **Gaia-centric epoch in TCB relative to 2455197.5 (Epoch_TCB, days)** |

#### 3. Astropy

1. æ•°æ®åˆ†ç±»ï¼šæ•°æ®æ ¹æ® `classify` åˆ—åˆ†ä¸ºå››å¤§ç±»ï¼š
   - ç¬¬1ç±» (`classify=1`)ï¼š
     - ä»… `file_line`ã€`year`ã€`mon` å’Œ `day` åˆ—æœ‰å€¼ã€‚
     - `day` åˆ—åŒ…å«å°æ•°ï¼Œè¡¨ç¤ºå®Œæ•´æ—¶é—´ï¼ˆåŒ…æ‹¬æ—¥ã€æ—¶ã€åˆ†ã€ç§’ï¼‰ã€‚å…¶ä»–åˆ—å‡ä¸ºç©ºã€‚
   - ç¬¬2ç±» (`classify=2`)ï¼š
     - ä»… `file_line`ã€`year`ã€`mon`ã€`day`ã€`hour`ã€`min` å’Œ `sec` åˆ—æœ‰å€¼ã€‚å…¶ä»–åˆ—å‡ä¸ºç©ºã€‚
   - ç¬¬3ç±» (`classify=3`)ï¼š
     - ä»… `jd` åˆ—æœ‰å€¼ã€‚å…¶ä»–åˆ—å‡ä¸ºç©ºã€‚
   - ç¬¬4ç±» (`classify=4`)ï¼š
     - ä¸ç¬¦åˆä¸Šè¿°ä»»ä½•åˆ†ç±»è§„åˆ™ï¼Œç›´æ¥è¾“å‡º `null`ã€‚
2. æ—¶é—´å°ºåº¦ï¼šæ•°æ®çš„æ—¶é—´å°ºåº¦å·²åœ¨ `scale` åˆ—ä¸­æ ‡æ˜ï¼Œå¯åŒ…å«ä»¥ä¸‹å€¼ï¼š
   - `UTC`ã€`TT`ã€`GMT`ã€`UT1`ã€`UTC-3h`ã€`ET`ã€`TCB`ã€`TDB`ã€‚
3. ç›®æ ‡è½¬æ¢ï¼š
   ä½¿ç”¨ PyMsOfa åº“æˆ–å…¶ä»–æ—¶é—´è½¬æ¢å·¥å…·ï¼Œåªå¯¹å‰ä¸‰ç±»å¤„ç†ï¼Œå°†ä¸åŒæ—¶é—´å°ºåº¦ã€ä¸åŒæ ¼å¼çš„æ•°æ®ç»Ÿä¸€è½¬æ¢ä¸º UTC æ—¶é—´ä¸‹çš„å„’ç•¥æ—¥ï¼ˆ`JD`ï¼‰ã€‚ç¬¬å››ç±»ç›´æ¥è¾“å‡ºnullã€‚
4. å­—æ®µå«ä¹‰ï¼š
   - `file_line`: æ•°æ®ç´¢å¼•æˆ–æ ‡è¯†ç¬¦ã€‚
   - `scale`: æ—¶é—´å°ºåº¦ï¼ˆå¦‚ UTCã€TT ç­‰ï¼‰ã€‚
   - `year`: å¹´ã€‚
   - `mon`: æœˆã€‚
   - `day`: æ—¥ã€‚
   - `hour`: å°æ—¶ã€‚
   - `min`: åˆ†é’Ÿã€‚
   - `sec`: ç§’ã€‚
   - `jd`: å„’ç•¥æ—¥ã€‚
   - `mjd`: ä¿®æ­£å„’ç•¥æ—¥ã€‚
   - `Epoch_TCB`: TCB æ—¶é—´çºªå…ƒã€‚
   - `classify`: åˆ†ç±»æ ‡è¯†ç¬¦ï¼ˆ1 è¡¨ç¤ºç¬¬ 1 ç±»ï¼Œ2 è¡¨ç¤ºç¬¬ 2 ç±»ï¼Œ3 è¡¨ç¤ºç¬¬ 3 ç±»ï¼Œ4 è¡¨ç¤ºç¬¬ 4 ç±»ï¼‰ã€‚

------

åˆæ­¥å®Œæˆäº†46380æ¡æ•°æ®çš„è½¬æ¢

```python
import pandas as pd
from astropy.time import Time
import numpy as np
import re  # ç”¨äºæ¸…ç†æ•°æ®
from PyQt5.QtWidgets import QApplication, QMessageBox, QTableWidget, QTableWidgetItem, QVBoxLayout, QWidget
import sys

# è¯»å– CSV æ–‡ä»¶
file_path = "./Result/time_scale.csv"  # æ›¿æ¢ä¸ºä½ çš„æ–‡ä»¶è·¯å¾„
df = pd.read_csv(file_path)

# å®šä¹‰æ¸…ç†å‡½æ•°
def clean_brackets(value):
    """å»é™¤å­—ç¬¦ä¸²ä¸­çš„æ–¹æ‹¬å·ï¼Œå¹¶è½¬æ¢ä¸ºæ•°å€¼"""
    if pd.isna(value):  # å¦‚æœæ˜¯ NaNï¼Œåˆ™ç›´æ¥è¿”å›
        return np.nan
    if isinstance(value, str):  # å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œå°è¯•å»æ‰æ–¹æ‹¬å·
        value = re.sub(r'[\[\]]', '', value)
    try:
        if '.' in value:  # å¦‚æœåŒ…å«å°æ•°ç‚¹ï¼Œè½¬æ¢ä¸ºæµ®ç‚¹æ•°
            return float(value)
        return int(value)  # å¦åˆ™è½¬æ¢ä¸ºæ•´æ•°
    except ValueError:
        return np.nan  # æ— æ³•è§£ææ—¶è¿”å› NaN

# æ¸…ç†éœ€è¦å¤„ç†çš„åˆ—
columns_to_clean = ['year', 'mon', 'day', 'hour', 'min', 'sec', 'jd']
for col in columns_to_clean:
    df[col] = df[col].apply(clean_brackets)

# å®šä¹‰è½¬æ¢å‡½æ•°
def convert_row_to_jd(row, errors):
    try:
        classify = int(row['classify'])  # ç¡®ä¿ classify æ˜¯æ•´æ•°
        scale = str(row['scale']).lower()  # ç¡®ä¿ scale å°å†™

        allowed_scales = ['local', 'tai', 'tcb', 'tcg', 'tdb', 'tt', 'ut1', 'utc']
        if scale not in allowed_scales:
            raise ValueError(f"Scale '{scale}' is not in the allowed scales {allowed_scales}")

        if classify == 1:
            # ç¬¬1ç±»ï¼šyear, mon, day (day åŒ…å«å°æ•°)
            year, mon, day = int(row['year']), int(row['mon']), float(row['day'])
            time = Time(f"{year}-{mon}-{day:.6f}", scale=scale, format='iso')
            return time.utc.jd

        elif classify == 2:
            # ç¬¬2ç±»ï¼šyear, mon, day, hour, min, sec
            year, mon, day = int(row['year']), int(row['mon']), int(row['day'])
            hour, minute, second = int(row['hour']), int(row['min']), float(row['sec'])
            time = Time(f"{year}-{mon}-{day} {hour}:{minute}:{second:.6f}", scale=scale, format='iso')
            return time.utc.jd

        elif classify == 3:
            # ç¬¬3ç±»ï¼šJD
            jd = float(row['jd'])
            time = Time(jd, scale=scale, format='jd')
            return time.utc.jd

        else:
            # ç¬¬4ç±»ï¼šç›´æ¥è¾“å‡º null
            return np.nan
    except Exception as e:
        # æ”¶é›†å¼‚å¸¸ä¿¡æ¯
        errors.append({'row': row.to_dict(), 'error': str(e)})
        return np.nan

# åˆå§‹åŒ– PyQt åº”ç”¨
app = QApplication(sys.argv)

# æ”¶é›†é”™è¯¯ä¿¡æ¯
errors = []

# åº”ç”¨è½¬æ¢å‡½æ•°
df['utc_jd'] = df.apply(lambda row: convert_row_to_jd(row, errors), axis=1)

# å¦‚æœæœ‰é”™è¯¯ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
if errors:
    # åˆ›å»ºçª—å£
    window = QWidget()
    window.setWindowTitle("Error Report")
    layout = QVBoxLayout()

    # åˆ›å»ºè¡¨æ ¼
    table = QTableWidget()
    table.setRowCount(len(errors))
    table.setColumnCount(2)
    table.setHorizontalHeaderLabels(["Row Data", "Error Message"])

    # å¡«å……è¡¨æ ¼
    for i, error in enumerate(errors):
        table.setItem(i, 0, QTableWidgetItem(str(error['row'])))
        table.setItem(i, 1, QTableWidgetItem(error['error']))

    layout.addWidget(table)
    window.setLayout(layout)
    window.show()

# ä¿å­˜ç»“æœåˆ°æ–°çš„ CSV æ–‡ä»¶
output_file = "./Result/output_time_scale.csv"
df.to_csv(output_file, index=False)

print(f"è½¬æ¢å®Œæˆï¼Œç»“æœå·²ä¿å­˜åˆ° {output_file}")

# è¿è¡Œ PyQt åº”ç”¨
sys.exit(app.exec_())
```

